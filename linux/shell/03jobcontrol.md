# 孤儿进程与终端的关系

## 孤儿进程

在本篇文章当中主要给大家介绍一下有关孤儿进程和终端之间的关系。

首先我们的需要知道什么是孤儿进程，简单的来说就是当一个程序还在执行，但是他的父进程已经退出了，这种进程叫做孤儿进程，因为父进程死亡了，因此被叫做孤儿进程。孤儿进程会被进程号等于 1 的 init 进程收养，也就是说他的新的父进程的进程号等于 1，我们可以使用下面的代码进行验证：

```c


#include <stdio.h>
#include <unistd.h>
#include <err.h>

int main()
{
  pid_t pid = fork();
  if(pid == -1)
  {
    perror("fork:");
  }
  printf("pid = %d ppid = %d\n", getpid(), getppid());
  if(pid == 0)
  {
    do
    {
      sleep(1);
      printf("pid = %d ppid = %d\n", getpid(), getppid());
    } while (1);
    
  }

  return 0;
}
```

上面的程序的输出结果如下所示：
```shell
➜  daemon git:(master) ✗ ./orphan.out 
pid = 25835 ppid = 25251
pid = 25836 ppid = 25835
➜  daemon git:(master) ✗ pid = 25836 ppid = 1
pid = 25836 ppid = 1
pid = 25836 ppid = 1
pid = 25836 ppid = 1
pid = 25836 ppid = 1
```

从上面终端的输出结果我们可以知道当父进程还没有退出的时候，子进程 25836 的父进程号还是 25835，但是当父进程退出之后，子进程的父进程号已经变成了 1 ，也就是 init 进程，这与我们在上面的分析的结果表现是一致的。

## 孤儿进程组和终端的关系

在前面我们提到了当一个进程的父进程退出之后，这个进程就会变成一个孤儿进程，其实与孤儿进程对应的有一个孤儿进程组，所谓孤儿进程组就是：一个进程组当中的进程要么是孤儿进程，要么父进程也在这个进程组当中，要么父进程在其他的会话当中，满足上述条件的进程组就是孤儿进程组。

